<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>カタカナ絵あてゲーム</title>
  <style>
    body {
      font-family: 'Noto Sans JP', sans-serif;
      text-align: center;
      background-color: #f9f9f9;
      padding: 20px;
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 1rem;
    }

    .hidden {
      display: none;
    }

    #menu button {
      margin: 5px;
      padding: 10px 20px;
      font-size: 1.2rem;
    }

    #hiragana {
      font-size: 4rem;
      margin: 20px;
    }

    #options {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .option-img {
      width: 100px;
      height: 100px;
      object-fit: contain;
      border: 3px solid transparent;
      border-radius: 10px;
      cursor: pointer;
    }

    #result {
      font-size: 3rem;
      margin-top: 20px;
    }

    #next-btn {
      margin-top: 20px;
      padding: 10px 30px;
      font-size: 1.2rem;
    }
  </style>
</head>
<body>

  <h1>カタカナ絵あてゲーム</h1>

  <div id="menu">
    <p>どの行から出題する？</p>
    <div id="row-buttons"></div>
  </div>

  <div id="game" class="hidden">
    <div id="hiragana">ア</div>
    <div id="options"></div>
    <div id="result"></div>
    <button id="next-btn" class="hidden">つぎ</button>
  </div>

  <audio id="correct-sound" src="pinpon.mp3"></audio>

  <script>
    const data = [
      { hira: 'あ', kata: 'ア', word: 'あり' },
      { hira: 'い', kata: 'イ', word: 'いぬ' },
      { hira: 'う', kata: 'ウ', word: 'うし' },
      { hira: 'え', kata: 'エ', word: 'えんぴつ' },
      { hira: 'お', kata: 'オ', word: 'おにぎり' },
      { hira: 'か', kata: 'カ', word: 'かめ' },
      { hira: 'き', kata: 'キ', word: 'きつね' },
      { hira: 'く', kata: 'ク', word: 'くるま' },
      { hira: 'け', kata: 'ケ', word: 'けむし' },
      { hira: 'こ', kata: 'コ', word: 'こま' },
      { hira: 'さ', kata: 'サ', word: 'さくらんぼ' },
      { hira: 'し', kata: 'シ', word: 'しか' },
      { hira: 'す', kata: 'ス', word: 'すいか' },
      { hira: 'せ', kata: 'セ', word: 'せみ' },
      { hira: 'そ', kata: 'ソ', word: 'そり' },
      { hira: 'た', kata: 'タ', word: 'たまご' },
      { hira: 'ち', kata: 'チ', word: 'ちょうちょ' },
      { hira: 'つ', kata: 'ツ', word: 'つくえ' },
      { hira: 'て', kata: 'テ', word: 'てぶくろ' },
      { hira: 'と', kata: 'ト', word: 'とり' },
      { hira: 'な', kata: 'ナ', word: 'なす' },
      { hira: 'に', kata: 'ニ', word: 'にわとり' },
      { hira: 'ぬ', kata: 'ヌ', word: 'ぬの' },
      { hira: 'ね', kata: 'ネ', word: 'ぬりえ' },
      { hira: 'の', kata: 'ノ', word: 'のり' },
      { hira: 'は', kata: 'ハ', word: 'はな' },
      { hira: 'ひ', kata: 'ヒ', word: 'ひよこ' },
      { hira: 'ふ', kata: 'フ', word: 'ふね' },
      { hira: 'へ', kata: 'ヘ', word: 'へび' },
      { hira: 'ほ', kata: 'ホ', word: 'ほし' },
      { hira: 'ま', kata: 'マ', word: 'まくら' },
      { hira: 'み', kata: 'ミ', word: 'みかん' },
      { hira: 'む', kata: 'ム', word: 'むしめがね' },
      { hira: 'め', kata: 'メ', word: 'めがね' },
      { hira: 'も', kata: 'モ', word: 'もも' },
      { hira: 'や', kata: 'ヤ', word: 'やま' },
      { hira: 'ゆ', kata: 'ユ', word: 'ゆきだるま' },
      { hira: 'よ', kata: 'ヨ', word: 'よる' },
      { hira: 'ら', kata: 'ラ', word: 'らっぱ' },
      { hira: 'り', kata: 'リ', word: 'りんご' },
      { hira: 'る', kata: 'ル', word: 'るすばん' },
      { hira: 'れ', kata: 'レ', word: 'れもん' },
      { hira: 'ろ', kata: 'ロ', word: 'ろうそく' },
      { hira: 'わ', kata: 'ワ', word: 'わに' },
      { hira: 'ん', kata: 'ン', word: 'ぱんだ' }
    ];

    const rows = {
      "ア行": ["ア", "イ", "ウ", "エ", "オ"],
      "カ行": ["カ", "キ", "ク", "ケ", "コ"],
      "サ行": ["サ", "シ", "ス", "セ", "ソ"],
      "タ行": ["タ", "チ", "ツ", "テ", "ト"],
      "ナ行": ["ナ", "ニ", "ヌ", "ネ", "ノ"],
      "ハ行": ["ハ", "ヒ", "フ", "ヘ", "ホ"],
      "マ行": ["マ", "ミ", "ム", "メ", "モ"],
      "ヤ行": ["ヤ", "ユ", "ヨ"],
      "ラ行": ["ラ", "リ", "ル", "レ", "ロ"],
      "ワ行": ["ワ", "ン"],
      "ゼンブ": data.map(d => d.kata)
    };

    const menu = document.getElementById("menu");
    const rowButtonsDiv = document.getElementById("row-buttons");
    const game = document.getElementById("game");
    const hiraganaDisplay = document.getElementById("hiragana");
    const optionsDiv = document.getElementById("options");
    const resultDiv = document.getElementById("result");
    const nextBtn = document.getElementById("next-btn");
    const correctSound = document.getElementById("correct-sound");

    let currentSet = [];
    let currentIndex = 0;

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function setupRowButtons() {
      Object.keys(rows).forEach(rowName => {
        const btn = document.createElement("button");
        btn.textContent = rowName;
        btn.onclick = () => startGame(rows[rowName]);
        rowButtonsDiv.appendChild(btn);
      });
    }

    function startGame(katas) {
      currentSet = shuffle(data.filter(d => katas.includes(d.kata)));
      currentIndex = 0;
      menu.classList.add("hidden");
      game.classList.remove("hidden");
      showQuestion();
    }

    function showQuestion() {
      const current = currentSet[currentIndex];
      hiraganaDisplay.textContent = current.kata;
      resultDiv.textContent = "";
      nextBtn.classList.add("hidden");

      const wrongs = shuffle(data.filter(d => d.word !== current.word)).slice(0, 4);
      const options = shuffle([current, ...wrongs]);

      optionsDiv.innerHTML = "";
      options.forEach(opt => {
        const img = document.createElement("img");
        img.src = "images/" + opt.word + ".png";
        img.className = "option-img";
        img.onclick = () => checkAnswer(opt.word, current.word);
        optionsDiv.appendChild(img);
      });
    }

    function checkAnswer(selected, correct) {
      if (selected === correct) {
        correctSound.play();
        resultDiv.textContent = "〇";
        resultDiv.style.color = "red";
      } else {
        resultDiv.textContent = "？";
        resultDiv.style.color = "black";
      }
      nextBtn.classList.remove("hidden");
    }

    nextBtn.onclick = () => {
      currentIndex++;
      if (currentIndex >= currentSet.length) {
        game.classList.add("hidden");
        menu.classList.remove("hidden");
      } else {
        showQuestion();
      }
    };

    setupRowButtons();
  </script>
</body>
</html>
