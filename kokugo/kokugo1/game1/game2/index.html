<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ひらがな絵あてゲーム</title>
  <style>
    body {
      font-family: 'Noto Sans JP', sans-serif;
      text-align: center;
      background-color: #f9f9f9;
      padding: 20px;
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 1rem;
    }

    .hidden {
      display: none;
    }

    #menu button {
      margin: 5px;
      padding: 10px 20px;
      font-size: 1.2rem;
    }

    #hiragana {
      font-size: 4rem;
      margin: 20px;
    }

    #options {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .option-img {
      width: 100px;
      height: 100px;
      object-fit: contain;
      border: 3px solid transparent;
      border-radius: 10px;
      cursor: pointer;
    }

    #result {
      font-size: 3rem;
      margin-top: 20px;
    }

    #next-btn {
      margin-top: 20px;
      padding: 10px 30px;
      font-size: 1.2rem;
    }
  </style>
</head>
<body>

  <h1>ひらがな絵あてゲーム</h1>

  <!-- 行選択画面 -->
  <div id="menu">
    <p>どの行から出題する？</p>
    <div id="row-buttons"></div>
  </div>

  <!-- ゲーム画面 -->
  <div id="game" class="hidden">
    <div id="hiragana">あ</div>
    <div id="options"></div>
    <div id="result"></div>
    <button id="next-btn" class="hidden">つぎ</button>
  </div>

  <audio id="correct-sound" src="pinpon.mp3"></audio>

  <script>
    const data = [
      { hira: 'あ', word: 'あり' },
      { hira: 'い', word: 'いぬ' },
      { hira: 'う', word: 'うし' },
      { hira: 'え', word: 'えんぴつ' },
      { hira: 'お', word: 'おにぎり' },
      { hira: 'か', word: 'かめ' },
      { hira: 'き', word: 'きつね' },
      { hira: 'く', word: 'くるま' },
      { hira: 'け', word: 'けーき' },
      { hira: 'こ', word: 'こま' },
      { hira: 'さ', word: 'さかな' },
      { hira: 'し', word: 'しまうま' },
      { hira: 'す', word: 'すいか' },
      { hira: 'せ', word: 'せみ' },
      { hira: 'そ', word: 'そり' },
      { hira: 'た', word: 'たこ' },
      { hira: 'ち', word: 'ちょうちょ' },
      { hira: 'つ', word: 'つくえ' },
      { hira: 'て', word: 'てぶくろ' },
      { hira: 'と', word: 'とり' },
      { hira: 'な', word: 'なす' },
      { hira: 'に', word: 'にわとり' },
      { hira: 'ぬ', word: 'ぬりえ' },
      { hira: 'ね', word: 'ねこ' },
      { hira: 'の', word: 'のり' },
      { hira: 'は', word: 'はな' },
      { hira: 'ひ', word: 'ひよこ' },
      { hira: 'ふ', word: 'ふね' },
      { hira: 'へ', word: 'へび' },
      { hira: 'ほ', word: 'ほし' },
      { hira: 'ま', word: 'まくら' },
      { hira: 'み', word: 'みかん' },
      { hira: 'む', word: 'むしめがね' },
      { hira: 'め', word: 'めがね' },
      { hira: 'も', word: 'もも' },
      { hira: 'や', word: 'やま' },
      { hira: 'ゆ', word: 'ゆきだるま' },
      { hira: 'よ', word: 'よる' },
      { hira: 'ら', word: 'らっぱ' },
      { hira: 'り', word: 'りんご' },
      { hira: 'る', word: 'るすばん' },
      { hira: 'れ', word: 'れもん' },
      { hira: 'ろ', word: 'ろうそく' },
      { hira: 'わ', word: 'わに' },
    ];

    const rows = {
      "あ行": ["あ", "い", "う", "え", "お"],
      "か行": ["か", "き", "く", "け", "こ"],
      "さ行": ["さ", "し", "す", "せ", "そ"],
      "た行": ["た", "ち", "つ", "て", "と"],
      "な行": ["な", "に", "ぬ", "ね", "の"],
      "は行": ["は", "ひ", "ふ", "へ", "ほ"],
      "ま行": ["ま", "み", "む", "め", "も"],
      "や行": ["や", "ゆ", "よ"],
      "ら行": ["ら", "り", "る", "れ", "ろ"],
      "わ行": ["わ"],
      "ぜんぶ": data.map(d => d.hira)
    };

    const rowButtonsDiv = document.getElementById("row-buttons");
    const menu = document.getElementById("menu");
    const game = document.getElementById("game");
    const hiraganaDisplay = document.getElementById("hiragana");
    const optionsDiv = document.getElementById("options");
    const resultDiv = document.getElementById("result");
    const nextBtn = document.getElementById("next-btn");
    const correctSound = document.getElementById("correct-sound");

    let currentSet = [];
    let currentIndex = 0;

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function setupRowButtons() {
      Object.keys(rows).forEach(rowName => {
        const btn = document.createElement("button");
        btn.textContent = rowName;
        btn.onclick = () => startGame(rows[rowName]);
        rowButtonsDiv.appendChild(btn);
      });
    }

    function startGame(hiras) {
      currentSet = shuffle(data.filter(d => hiras.includes(d.hira)));
      currentIndex = 0;
      menu.classList.add("hidden");
      game.classList.remove("hidden");
      showQuestion();
    }

    function showQuestion() {
      const current = currentSet[currentIndex];
      hiraganaDisplay.textContent = current.hira;
      resultDiv.textContent = "";
      nextBtn.classList.add("hidden");

      const wrongs = shuffle(data.filter(d => d.word !== current.word)).slice(0, 4);
      const options = shuffle([current, ...wrongs]);

      optionsDiv.innerHTML = "";
      options.forEach(opt => {
        const img = document.createElement("img");
        img.src = "images/" + opt.word + ".png";
        img.className = "option-img";
        img.onclick = () => checkAnswer(opt.word, current.word);
        optionsDiv.appendChild(img);
      });
    }

    function checkAnswer(selected, correct) {
      if (selected === correct) {
        correctSound.play();
        resultDiv.textContent = "〇";
        resultDiv.style.color = "red";
      } else {
        resultDiv.textContent = "？";
        resultDiv.style.color = "black";
      }
      nextBtn.classList.remove("hidden");
    }

    nextBtn.onclick = () => {
      currentIndex++;
      if (currentIndex >= currentSet.length) {
        game.classList.add("hidden");
        menu.classList.remove("hidden");
      } else {
        showQuestion();
      }
    };

    setupRowButtons();
  </script>
</body>
</html>
